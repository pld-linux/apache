--- httpd-2.2.3/support/apxs.in-orig	2006-11-01 00:59:27.000000000 +0100
+++ httpd-2.2.3/support/apxs.in	2006-11-01 00:59:54.000000000 +0100
@@ -35,6 +35,7 @@
 my $exec_prefix    = get_vars("exec_prefix");
 my $datadir        = get_vars("datadir");
 my $localstatedir  = get_vars("localstatedir");
+my $libdir	   = get_vars("libdir");
 my $CFG_TARGET     = get_vars("progname");
 my $CFG_SYSCONFDIR = get_vars("sysconfdir");
 my $CFG_CFLAGS     = join ' ', map { get_vars($_) }
@@ -44,6 +45,7 @@
 my $CFG_CC         = get_vars("CC");
 my $libexecdir     = get_vars("libexecdir");
 my $CFG_LIBEXECDIR = eval qq("$libexecdir");
+my $CFG_DESTDIR    = '';
 my $sbindir        = get_vars("sbindir");
 my $CFG_SBINDIR    = eval qq("$sbindir");
 my $ltflags        = $ENV{'LTFLAGS'};
@@ -171,7 +173,7 @@
 	    my ($val) = $2;
 	    my $oldval = eval "\$CFG_$var";
 
-	    unless ($var and $oldval) {
+	    unless ($var and defined $oldval) {
 		print STDERR "apxs:Error: no config variable $var\n";
 		&usage;
 	    }
@@ -199,11 +201,10 @@
     ($httpd = $0) =~ s:support/apxs$::;
 }
 
-unless (-x "$httpd") {
-	error("$httpd not found or not executable");
-	exit 1;
+if (not -x "$httpd") {
+	print STDERR "Note: $httpd not found or not executable.\n";
 }
-
+else {
 unless (grep /mod_so/, `. $envvars && $httpd -l`) {
     error("Sorry, no shared object support for Apache");
     error("available under your platform. Make sure");
@@ -211,7 +212,7 @@
     error("your server binary `$httpd'.");
     exit 1;
 }
-
+}
 sub get_config_vars{
     my ($file, $rh_config) = @_;
 
@@ -479,8 +480,8 @@
         $t =~ s|\.[^./\\]+$|\.so|;
         if ($opt_i) {
 	    push(@cmds, "$installbuilddir/instdso.sh SH_LIBTOOL='" .
-                 "$libtool' $f $CFG_LIBEXECDIR");
-	    push(@cmds, "chmod 755 $CFG_LIBEXECDIR/$t");
+                 "$libtool' $f $CFG_DESTDIR$CFG_LIBEXECDIR");
+	    push(@cmds, "chmod 755 $CFG_DESTDIR$CFG_LIBEXECDIR/$t");
         }
 
         #   determine module symbolname and filename
